<!DOCTYPE html>
<html lang="de">

<head>
	<meta charset="UTF-8">
	<style>
		body {
			font-family: monospace;
			background: #0f172a;
			color: #38bdf8;
			display: flex;
			justify-content: center;
			align-items: center;
			height: 100vh;
		}

		.box {
			background: #020617;
			padding: 20px 30px;
			border-radius: 8px;
			box-shadow: 0 0 20px #38bdf8;
		}
	</style>
</head>

<body>
	<div class="box">
		your IP-adress:<br>
		<strong id="ip">Lade...</strong>
	</div>

	<!-- Firebase SDK -->
	<script type="module">
		import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
		import { getDatabase, ref, push, get } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-database.js";

		// Ersetze dies mit deinen Firebase-Anmeldedaten
		const firebaseConfig = {
			apiKey: "AIzaSyBLimjEiu2kEYTOmD8Of0r2rxLCIzze0YQ",
			authDomain: "what-is-my-ip-adress.firebaseapp.com",
			databaseURL: "https://what-is-my-ip-adress-default-rtdb.firebaseio.com",
			projectId: "what-is-my-ip-adress",
			storageBucket: "what-is-my-ip-adress.firebasestorage.app",
			messagingSenderId: "133534700105",
			appId: "1:133534700105:web:669bca3469d9b673d62598"
		};

		const app = initializeApp(firebaseConfig);
		const database = getDatabase(app);

		window.getPublicIP = async function() {
			try {
				const response = await fetch('https://api.ipify.org?format=json');
				const data = await response.json();
				document.getElementById('ip').textContent = data.ip;

				// Speichere IP in Firebase
				const timestamp = new Date().toLocaleString('de-DE');
				const ipsRef = ref(database, 'ips');
				push(ipsRef, {
					ip: data.ip,
					time: timestamp
				});
			} catch (err) {
				document.getElementById('ip').textContent = 'Fehler: ' + err;
			}
		}

		window.runIPshow = async function() {
			try {
				const ipsRef = ref(database, 'ips');
				const snapshot = await get(ipsRef);

				if (!snapshot.exists()) {
					console.log('Keine IP-Adressen gespeichert');
					return;
				}

				const ipsData = snapshot.val();
				const ipList = Object.values(ipsData);

				console.log('=== ALLE eingeloggten IP-Adressen ===');
				ipList.forEach((entry, index) => {
					console.log(`${index + 1}. IP: ${entry.ip} | Zeit: ${entry.time}`);
				});
				console.log(`Gesamt: ${ipList.length} Besuche`);
			} catch (err) {
				console.log('Fehler beim Abrufen der IPs:', err.message);
			}
		}

		getPublicIP();
	</script>
</body>

</html>