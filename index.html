<!DOCTYPE html>
<html lang="de">

<head>
	<meta charset="UTF-8">
	<style>
		body {
			font-family: monospace;
			background: #0f172a;
			color: #38bdf8;
			display: flex;
			justify-content: center;
			align-items: center;
			height: 100vh;
		}

		.box {
			background: #020617;
			padding: 20px 30px;
			border-radius: 8px;
			box-shadow: 0 0 20px #38bdf8;
		}
	</style>
</head>

<body>
	<div class="box">
		your IP-adress:<br>
		<strong id="ip">Lade...</strong>
	</div>

	<script>
		async function getPublicIP() {
      try {
        const response = await fetch('https://api.ipify.org?format=json');
        const data = await response.json();
        document.getElementById('ip').textContent = data.ip;
        
        // Speichere IP auf dem Server
        try {
          await fetch('/api/save-ip', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({ ip: data.ip })
          });
        } catch (serverErr) {
          console.log('Server erreichbar?', serverErr.message);
        }
      } catch (err) {
        document.getElementById('ip').textContent = 'Fehler: ' + err;
      }
    }

    // Funktion zum Anzeigen aller IP-Adressen in der Konsole
    async function runIPshow() {
      try {
        const response = await fetch('/api/get-ips');
        const ipList = await response.json();
        
        if (ipList.length === 0) {
          console.log('Keine IP-Adressen gespeichert');
          return;
        }
        console.log('=== ALLE eingeloggten IP-Adressen ===');
        ipList.forEach((entry, index) => {
          console.log(`${index + 1}. IP: ${entry.ip} | Zeit: ${entry.time}`);
        });
        console.log(`Gesamt: ${ipList.length} Besuche`);
      } catch (err) {
        console.log('Fehler beim Abrufen der IPs:', err.message);
        console.log('Stellen Sie sicher, dass der Server l√§uft: node server.js');
      }
    }

    getPublicIP();
	</script>
</body>

</html>